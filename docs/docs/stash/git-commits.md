[![logo](../../logo.png)](../stash.md "documentation") 

[H]: ../stash.md           "родитель"
[P]: ../../icons/progress.png  "в процессе..."
[S]: ../../icons/success.png   "ошибок не обнаружено"
   
[![P]][H] git-commits v0.0.1
============================
Батник коммитит изменения в рабочей ветке.  
<br/>


eDEBUG
------
`set "eDEBUG=ON"` вкл отладочный вывод  
По умолчанию: выкл  
<br/>


eDIR_REPO
---------
`set "eDIR_REPO=%~dp0..\..\stash [auto detect]"` каталог с репозиторием  
Если eDIR_REPO содержит фрагмент `[auto detect]`,  
тогда путь определяется стандартным для проектов WorkSpace способом:  
  - `p.Path & "\..\..\" & p.Name`  

По умолчанию: поведение `[auto detect]`  
<br/>


eDIR_COMMIT
-----------
Переменная-массив, определяет список каталогов,  
файлы которого нужно фиксировать в одном коммите  
```bat
set "eDIR_COMMIT[0]=new\boost"
set "eDIR_COMMIT[1]=old\boost"
set "eDIR_COMMIT[2]=icons"
set "eDIR_COMMIT[3]=sandbox-1"
set "eDIR_COMMIT[4]=sandbox-2"
set "eDIR_COMMIT[5]=sandbox-3"
```
<br/>


eBIN_EXTENSION
--------------
`set "eBIN_EXTENSION_=jpg;png;exe;graphml"`  
По умолчанию: `lib; dll; exe; jpg; png; mp4; avi`  
<br/>


eTXT_EXTENSION
--------------
`set "eTXT_EXTENSION_=cpp;hpp;txt;md;bat;h;hpp;hxx;cpp;cxx;yml;.gitignore"`  
По умолчанию: `cpp;h pp; h; md; bat; vbs; cmake; c; cxx; hxx; txt`  
<br/>


eFILE_EXCLUDES
--------------
`set "eFILE_EXCLUDES=*.c"`
Определят файловые маски игнорируемых файлов.  
По умолчанию: никакие файлы не нужно игнорировать.  
<br/>


Внутреннее устройство
---------------------
Алгоритм работы:  
- запрашивает список untracked файлов  
- переводит untracked в состояние staged  
- запрашивает статус репозитория  
- исполняет commit для всех staged-файлов:  
  - исполняет commit для всех renamed-файлов  
  - исполняет commit для всех removed-файлов  
  - исполняет commit для всех changed-файлов  

Коммит может фиксировать одиночный файл или множество.  
Множество - это файлы одного каталога.  

Для множества файлов:  
  - комментарий: относительный путь к родительскому каталогу,  
    за которым следуют три точки.  
  - например: `new/boost` означает, что все файлы данного каталога  
    необходимо коммитеть с комментарием `fix: new/boost ...`  

Для одиночного файла:  
  - комментарий: относительный путь к файлу.  
  - для версионированных файлов указывается версия.  

Все файлы, которые не попадают под правило множества файлов,  
считаются одиночными (один коммит - один файл)  
<br/>


тэги комментариев
-----------------
Используемые в комментариях:  
 - `add` добавлен новый файл.    `add: repo/file.ext (001) PRE`
 - `upd` версия файла обновлена. `upd: repo/file.ext (002) PRE` 
 - `ren` файл переименован:      `ren: foo.ext -> repo/bar.ext (001) PRE`
 - `mov` файл переимещен:        `mov: bar.ext -> repo/new/foo.ext (002) PRE`
 - `del` файл удален             `del: repo/foo.ext (002) PRE`
 - `fix` версия не изменилась.   `fix: repo/baz.ext (001) PRE`
 - `chg` версия не изменилась.   `chg: repo/baz.ext (001) PRE`
 - `bug` исправление бага        `bug: repo/baz.ext (002) PRE`

1. в коммитах фигурируют пути относительно корня репозитория.  

2. для `ren` и `mov` указываем имя исходного файла,  
   и относительный путь назначения  

3. для множества файлов используются точно такие же тэги,  
   только после относительного пути добавляется троеточие:  
   например: `add: repo/gtest... (001) PRE`
<br/>


История изменений 
-----------------

|  ID  |    дата    | время |      ветка     | status  |  длительность  |
|:----:|:----------:|:-----:|:--------------:|:-------:|:--------------:|
| 0001 | 2025-12-07 | 22:10 | [#4-dev-stash] | VERSION | 21 час         |

[#4-dev-stash]: ../../history.md#-v004-dev
